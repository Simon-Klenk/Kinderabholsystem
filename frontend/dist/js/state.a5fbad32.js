"use strict";(self["webpackChunkkinderabholung"]=self["webpackChunkkinderabholung"]||[]).push([[522],{5869:function(e,t,s){s.r(t),s.d(t,{default:function(){return D}});var a=s(6768);const n={class:"messages-container"},i={key:0,class:"loading"},r={key:1};function d(e,t,s,d,o,l){const c=(0,a.g2)("MessageItem");return(0,a.uX)(),(0,a.CE)("div",n,[t[0]||(t[0]=(0,a.Lk)("h2",{class:"messages-title"},"Gesendete Nachrichten",-1)),o.loading?((0,a.uX)(),(0,a.CE)("div",i,"⏳ Lade Nachrichten...")):((0,a.uX)(),(0,a.CE)("div",r,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.messages,(e=>((0,a.uX)(),(0,a.Wv)(c,{key:e.id,text:e.content,date:e.created_at,state:e.status},null,8,["text","date","state"])))),128))]))])}var o=s(4232);const l={class:"message-item"},c={class:"message-text"},h={class:"message-meta"},u={class:"message-date"},g={class:"message-state"},p={key:0,class:"tooltip"};function m(e,t,s,n,i,r){return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",c,[t[1]||(t[1]=(0,a.eW)(" Die Eltern von ")),(0,a.Lk)("strong",null,(0,o.v_)(s.text),1),t[2]||(t[2]=(0,a.eW)(" bitte zum Check-in kommen "))]),(0,a.Lk)("div",h,[(0,a.Lk)("span",u,(0,o.v_)(r.formattedDate),1),(0,a.Lk)("div",g,[(0,a.Lk)("span",{class:(0,o.C4)(r.statusClass)},(0,o.v_)(r.translatedState),3),(0,a.Lk)("span",{class:"info-icon",onClick:t[0]||(t[0]=(...e)=>r.toggleTooltip&&r.toggleTooltip(...e))},"❓"),i.showTooltip?((0,a.uX)(),(0,a.CE)("div",p,(0,o.v_)(r.statusExplanation),1)):(0,a.Q3)("",!0)])])])}var v={name:"MessageItem",props:{text:String,date:String,state:String},data(){return{showTooltip:!1}},computed:{formattedDate(){return new Date(this.date).toLocaleString()},translatedState(){const e={received:"Wartet auf Freigabe",approved:"Wird angezeigt",rejected:"Wurde abgelehnt",sent:"An AV Gesendet",displayed:"Wurde angezeigt"};return e[this.state]||this.state},statusExplanation(){const e={received:"Das AV-Team hat deine Nachricht erhalten. Es entscheidet jetzt wann und ob es deine Nachricht auf der LED-Wall anzeigt. Du wirst hier informiert, sobald es eine Entscheidung trifft",approved:"Das AV-Team zeigt deine Nachricht gerade auf der LED-Wall an.",rejected:"Das AV-Team hat entschieden deine Nachricht nicht auf der LED-Wall anzuzeigen.",sent:"Deine Nachricht wird gerade an das AV-Team gesendet, ist aber noch nicht dort angekommen.",displayed:"Deine Nachricht ist jetzt nicht mehr auf der LED-Wall zu sehen. Sie wurde aber angezeigt."};return e[this.state]||""}},methods:{toggleTooltip(){this.showTooltip=!this.showTooltip},statusClass(){return{"status-pending":"received"===this.state,"status-success":"approved"===this.state,"status-error":"rejected"===this.state,"status-sent":"sent"===this.state,"status-displayed":"displayed"===this.state}}}},k=s(1241);const f=(0,k.A)(v,[["render",m],["__scopeId","data-v-386e3252"]]);var E=f,w={components:{MessageItem:E},data(){return{messages:[],loading:!0,intervalId:null}},async created(){await this.getMessages(),this.startPolling()},beforeUnmount(){this.stopPolling()},methods:{async getMessages(){try{let e=await fetch("http://192.168.104.45/api/messages/",{method:"GET"});if(!e.ok)throw new Error(`HTTP-Fehler! Status: ${e.status}`);this.messages=await e.json(),this.loading=!1}catch(e){console.error("Fehler beim Abrufen der Nachrichten:",e),this.loading=!1}},startPolling(){this.intervalId=setInterval(this.getMessages,4e3)},stopPolling(){this.intervalId&&clearInterval(this.intervalId)}}};const b=(0,k.A)(w,[["render",d],["__scopeId","data-v-4e32ca43"]]);var D=b}}]);
//# sourceMappingURL=state.a5fbad32.js.map